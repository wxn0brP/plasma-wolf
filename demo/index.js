class y{dx;dy;constructor(t,a){this.dx=t;this.dy=a}}function u(t,a,o=55){let{dx:i,dy:e}=t;if(i===0&&e===0)return a;let n=Math.abs(i),s=Math.abs(e);if(n<o&&s<o)return a;let r=R(t),c=360/a/2,l=r+90+c;return L(l,a)}function R(t){let a=Math.atan2(t.dy,t.dx);if(a=a*(180/Math.PI),a<0)a+=360;return a}function L(t,a){let o=360/a,i=Math.floor(t/o);return i=i%a,i}function C({dx:t,dy:a}){return Math.sqrt(t*t+a*a)}function M(t,a){let o=[],i=2*Math.PI/a;for(let e=0;e<a;e++){let n=e*i-Math.PI/2,s=t*Math.cos(n),r=t*Math.sin(n);o.push(Math.round(s),Math.round(r))}return o}function p(t,a,o,i){return new y(o-t,i-a)}function k(t){let i=102+6*t;if(t>8)i+=(t-8)*4;return i}class f{parent;radius;constructor(t,a=0){this.parent=t;this.radius=a;this.parent.innerHTML="",this._actualRadius=a}body=[];selectedClass="selected";_actualRadius;genBody(t,a){this.parent.innerHTML="",this.body=[];let o=M(this._getRadius(t.length),t.length);for(let e=0;e<t.length;e++){let n=document.createElement("div");n.classList.add("wolf-menu-item"),n.style.left=`${o[e*2]}px`,n.style.top=`${o[e*2+1]}px`,n.innerHTML=t[e].name,this.parent.appendChild(n),this.body.push(n)}let i=document.createElement("div");i.classList.add("wolf-menu-item"),i.classList.add("wolf-menu-item-cancel"),i.style.left="0",i.style.top="0",i.innerHTML=a.name,this.parent.appendChild(i),this.body.push(i)}_getRadius(t){if(this.radius===0)this._actualRadius=k(t);else this._actualRadius=this.radius;return this._actualRadius}clearSelected(){this.body.forEach((t)=>t.classList.remove(this.selectedClass))}select(t){this.body[t].classList.add(this.selectedClass)}}class _{_events={};on(t,a){let o=t;if(!this._events[o])this._events[o]=[];this._events[o].push(a)}once(t,a){let o=(...i)=>{this.off(t,o),a(...i)};this.on(t,o)}off(t,a){let o=t;if(!this._events[o])return;this._events[o]=this._events[o].filter((i)=>i!==a)}emit(t,...a){let o=this._events[t];if(o&&o.length>0)o.forEach((i)=>{i(...a)})}listenerCount(t){return this._events[t]?.length||0}}class g{_commands;_element;constructor(t,a){this._commands=t;this._element=a;let o=document.createElement("div");o.classList.add("wolf-menu-items"),this._element.appendChild(o),this.body=new f(o),this._element.style.display="none"}_x=0;_y=0;_startX=0;_startY=0;_active=!1;_selectedCommands;_logFn=console.log;_cancelCommand={name:"Cancel",action:()=>{}};body;emitter=new _;distanceAccept=!0;distanceCount=60;startCommand="start";init(){this._initMove(),this._initClick(),this.emitter.emit("initialized")}_initMove(){document.addEventListener("mousemove",(t)=>{if(this._x=t.clientX,this._y=t.clientY,!this._active)return;this.body.clearSelected();let a=p(this._startX,this._startY,this._x,this._y),o=u(a,this._selectedCommands.length);this.body.select(o);let i=C(a);if(this.emitter.emit("distance",i,o),!this.distanceAccept)return;if(i>this.body._actualRadius+this.distanceCount)this._selected()})}_initClick(){document.addEventListener("click",(t)=>{if(this._x=t.clientX,this._y=t.clientY,this._active)this._selected();else this._openMenu()})}_openMenu(t=this.startCommand){if(this._selectedCommands=this._commands[t],!this._selectedCommands)return this._logFn(`Command "${t}" not found!`);this._element.style.display="",this._element.style.top=this._y+"px",this._element.style.left=this._x+"px",this.body.genBody(this._selectedCommands,this._cancelCommand),this._active=!0,this._setStart(),this.body.select(this.getDirection()),this.emitter.emit("menuOpened",t)}_selected(){this._element.style.display="none",this._active=!1;let t=this.getDirection(),a=t>this._selectedCommands.length?this._cancelCommand:this._selectedCommands[t];if(this.emitter.emit("menuClosed"),!a)return;if(this.emitter.emit("commandSelected",a),"go"in a){this._openMenu(a.go);return}if("action"in a)a.action(),this.emitter.emit("commandExecuted",a);else this._logFn("Unknown command type",a)}getDirection(t){if(!t)t=p(this._startX,this._startY,this._x,this._y);return u(t,this._selectedCommands.length)}_setStart(t=this._x,a=this._y){this._startX=t,this._startY=a}setRadius(t){this.body.radius=t}}(()=>{var t=Object.defineProperty,a=(e,n)=>t(e,"name",{value:n,configurable:!0}),o={html(e){return e!==void 0?(this.innerHTML=e,this):this.innerHTML},v(e){return e!==void 0?(this.value=e,this):this.value},on(e,n){return this.addEventListener(e,n),this},css(e,n=null){return typeof e=="string"?n!==null?this.style[e]=n:this.style.cssText=e:Object.assign(this.style,e),this},attrib(e,n=null){return n!==null?(this.setAttribute(e,n),this):this.getAttribute(e)||""},clA(...e){return this.classList.add(...e),this},clR(...e){return this.classList.remove(...e),this},clT(e,n){return this.classList.toggle(e,n),this},animateFade(e,n={}){let{time:s=200,cb:r}=n,c=this,l=e===0?1:0,h=Math.min(1,Math.max(0,e)),x=performance.now();c.style.opacity=h.toString();function d(D){let Y=D-x,b=Math.min(Y/s,1),T=h+(l-h)*b;c.style.opacity=T.toString(),b<1?requestAnimationFrame(d):(c.style.opacity=l.toString(),r?.())}return a(d,"step"),requestAnimationFrame(d),this},fadeIn(...e){let n=i({display:"string",cb:"function",time:"number"},e),{display:s="block"}=n;return this.css("display",s),this.animateFade(0,n),this.fade=!0,this},fadeOut(...e){let n=i({cb:"function",time:"number"},e),s=n.time??300;return n.time=s,this.animateFade(1,{...n,cb:a(()=>{this.css("display","none"),n.cb?.()},"cb")}),this.fade=!1,this},async fadeInP(...e){return new Promise((n)=>{this.fadeIn(...e,()=>n(this))})},async fadeOutP(...e){return new Promise((n)=>{this.fadeOut(...e,()=>n(this))})},fade:!0,fadeToggle(){return this.fade?this.fadeOut():this.fadeIn(),this},add(e){return this.appendChild(e),this},addUp(e){return this.insertBefore(e,this.firstChild),this},qs(e,n=0){return n&&(e=`[data-id="${e}"]`),this.querySelector(e)},qi(e,n=0){return this.qs(e,n)}};function i(e,n){let s={};if(n.length===0)return s;if(n.every((r)=>typeof r=="object"))return Object.assign({},...n);for(let r of n)for(let[c,l]of Object.entries(e))if(typeof r===l){s[c]=r;break}return s}a(i,"convert"),Object.assign(HTMLElement.prototype,o),Object.assign(document,o),Object.assign(document.body,o),Object.assign(document.documentElement,o);for(let e of["qs","qi"])typeof o[e]=="function"&&(window[e]=function(...n){return o[e].apply(document,n)})})();var S={start:[{name:"Go to the forest",go:"forest"},{name:"Enter the castle",go:"castle"},{name:"Return to the village",go:"village"},{name:"Explore the cave",go:"cave"}],forest:[{name:"Gather berries",action:()=>alert("You gathered some delicious berries.")},{name:"Take a rest",action:()=>alert("You took a short rest.")},{name:"Find a stream",action:()=>alert("You found a stream with cool, clear water.")},{name:"Go deeper in the forest",go:"deep_forest"},{name:"Return to the start",go:"start"},{name:"Light a fire",action:()=>alert("You lit a fire and felt warm.")},{name:"Listen to the forest sounds",action:()=>alert("You listened carefully and heard some soothing sounds.")},{name:"Take a break",action:()=>alert("You took a short break.")}],castle:[{name:"Enter the throne room",go:"throne_room"},{name:"Talk to the guard",action:()=>alert("The guard says: 'You cannot pass without permission.'")},{name:"Explore the garden",action:()=>alert("The garden is empty and quiet.")},{name:"Enter the dungeon",go:"dungeon"},{name:"Return to the start",go:"start"},{name:"Visit the library",go:"library"},{name:"Use the lavatory",action:()=>alert("You hear the sound of running water.")}],village:[{name:"Talk to the blacksmith",action:()=>alert("Blacksmith: 'How can I help you with the new month?'")},{name:"Visit the shopkeeper",action:()=>alert("Shopkeeper: 'Welcome to my humble shop.'")},{name:"Feed the beggar",action:()=>alert("The beggar thanks you for the food.")},{name:"Return to the start",go:"start"},{name:"Get a drink",action:()=>alert("You take a refreshing drink.")},{name:"Take a walk at night",go:"forest"}],cave:[{name:"Go deeper",go:"deep_cave"},{name:"Write on the wall",action:()=>alert("You write an old rhyme on the wall.")},{name:"Light a match",action:()=>alert("The match flickers and casts a small, warm glow.")},{name:"Shout",action:()=>alert("Your voice echoes off the walls... and something else.")},{name:"Return to the start",go:"start"},{name:"Bang on the pipe",action:()=>alert("The pipe makes a loud, hollow clang.")},{name:"Repeat after the echo",action:()=>alert("The echo repeats your words back to you.")},{name:"Take a break at the entrance",action:()=>alert("You take a short break at the entrance.")}]},w=qs(".wolf"),m=new g(S,w);m.init();m.emitter.on("distance",(t)=>{let a=m.body._actualRadius+m.distanceCount,o=Math.min(1,t/a);w.style.setProperty("--alpha",o.toString())});export{S as commands};

//# debugId=E246E7883B861CDB64756E2164756E21
//# sourceMappingURL=index.js.map
